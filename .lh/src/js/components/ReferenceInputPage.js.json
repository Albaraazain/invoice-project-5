{
    "sourceFile": "src/js/components/ReferenceInputPage.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1731019030943,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1731019184731,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -320,9 +320,9 @@\n   }\r\n \r\n   getLogoTemplate() {\r\n     return `\r\n-        <img src=\"/src/assets/logo.svg\" alt=\"Logo\" class=\"logo-icon -ml-8 -mt-8\" style=\"width: 13rem; height: 13rem;\" />\r\n+        <img src=\"/assets/logo.svg\" alt=\"Logo\" class=\"logo-icon -ml-8 -mt-8\" style=\"width: 13rem; height: 13rem;\" />\r\n         \r\n     `;\r\n   }\r\n \r\n"
                },
                {
                    "date": 1731019496092,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -320,9 +320,9 @@\n   }\r\n \r\n   getLogoTemplate() {\r\n     return `\r\n-        <img src=\"/assets/logo.svg\" alt=\"Logo\" class=\"logo-icon -ml-8 -mt-8\" style=\"width: 13rem; height: 13rem;\" />\r\n+        <img src=\"./logo.svg\" alt=\"Logo\" class=\"logo-icon -ml-8 -mt-8\" style=\"width: 13rem; height: 13rem;\" />\r\n         \r\n     `;\r\n   }\r\n \r\n"
                },
                {
                    "date": 1731019611729,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -320,9 +320,9 @@\n   }\r\n \r\n   getLogoTemplate() {\r\n     return `\r\n-        <img src=\"./logo.svg\" alt=\"Logo\" class=\"logo-icon -ml-8 -mt-8\" style=\"width: 13rem; height: 13rem;\" />\r\n+        <img src=\"/src/assets/logo.svg\" alt=\"Logo\" class=\"logo-icon -ml-8 -mt-8\" style=\"width: 13rem; height: 13rem;\" />\r\n         \r\n     `;\r\n   }\r\n \r\n"
                }
            ],
            "date": 1731019030943,
            "name": "Commit-0",
            "content": "// ReferenceInputPage.js\r\nimport { fetchBillData } from \"../store/solarSizingState.js\";\r\n\r\nexport class ReferenceInputPage {\r\n  constructor() {\r\n    this.state = {\r\n      provider: \"\",\r\n      referenceNumber: \"\",\r\n      whatsapp: \"\",\r\n      isLoading: false,\r\n      error: null,\r\n    };\r\n\r\n    // Inject base styles when class is instantiated\r\n    this.injectBaseStyles();\r\n    this.injectUtilityStyles();\r\n    this.injectAnimationStyles();\r\n  }\r\n\r\n  injectBaseStyles() {\r\n    const style = document.createElement(\"style\");\r\n    style.textContent = `\r\n          /* Reset and Base Styles */\r\n          * {\r\n              margin: 0;\r\n              padding: 0;\r\n              box-sizing: border-box;\r\n          }\r\n\r\n          :root {\r\n              --color-primary: #00a651;\r\n              --color-primary-dark: #008c44;\r\n              --color-primary-light: rgba(0, 166, 81, 0.1);\r\n              --color-yellow: #ffde17;\r\n              --color-gray-800: #2d3748;\r\n              --color-gray-600: #4a5568;\r\n              --color-gray-400: #cbd5e0;\r\n              --color-gray-200: #edf2f7;\r\n              --color-white: #ffffff;\r\n          }\r\n\r\n          body {\r\n              font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \r\n                         \"Helvetica Neue\", Arial, sans-serif;\r\n              line-height: 1.5;\r\n              color: var(--color-gray-800);\r\n          }\r\n\r\n          /* Main Container Styles */\r\n          .main-content {\r\n              position: relative;\r\n              width: 100%;\r\n              min-height: 100vh;\r\n              background-color: var(--color-white);\r\n              overflow: hidden;\r\n          }\r\n\r\n          /* Logo Section */\r\n          .logo-section {\r\n              position: absolute;\r\n              top: 2rem;\r\n              left: 3rem;\r\n              display: flex;\r\n              align-items: center;\r\n              gap: 0.5rem;\r\n              z-index: 10;\r\n          }\r\n\r\n          .logo-icon {\r\n              width: 3rem;\r\n              height: 3rem;\r\n          }\r\n\r\n          .logo-text h1 {\r\n              font-size: 1.5rem;\r\n              font-weight: 700;\r\n              color: var(--color-gray-800);\r\n          }\r\n\r\n          .logo-text p {\r\n              font-size: 0.875rem;\r\n              font-style: italic;\r\n              color: var(--color-gray-600);\r\n          }\r\n\r\n          /* Layout Grid */\r\n          .layout-grid {\r\n              display: flex;\r\n              height: 100vh;\r\n          }\r\n\r\n          /* Form Section */\r\n          .form-section {\r\n              width: 66.666667%;\r\n              padding: 2rem;\r\n              display: flex;\r\n              align-items: center;\r\n              justify-content: center;\r\n          }\r\n\r\n          .form-container {\r\n              max-width: 28rem;\r\n              width: 100%;\r\n          }\r\n\r\n          .form-title {\r\n              font-size: 2.25rem;\r\n              font-weight: 700;\r\n              color: var(--color-primary);\r\n              margin-bottom: 2rem;\r\n          }\r\n\r\n          /* Form Elements */\r\n          .form-group {\r\n              margin-bottom: 1.5rem;\r\n          }\r\n\r\n          .form-label {\r\n              display: block;\r\n              font-size: 0.875rem;\r\n              color: var(--color-gray-600);\r\n              margin-bottom: 0.5rem;\r\n          }\r\n\r\n          .form-input {\r\n              width: 100%;\r\n              height: 2.5rem;\r\n              padding: 0 1rem;\r\n              border: 1px solid var(--color-gray-400);\r\n              border-radius: 0.375rem;\r\n              transition: all 0.2s ease;\r\n          }\r\n\r\n          .form-input:focus {\r\n              outline: none;\r\n              border-color: var(--color-primary);\r\n              box-shadow: 0 0 0 3px var(--color-primary-light);\r\n          }\r\n\r\n          .form-button {\r\n              width: 100%;\r\n              height: 3rem;\r\n              background-color: var(--color-primary);\r\n              color: var(--color-white);\r\n              border: none;\r\n              border-radius: 9999px;\r\n              font-weight: 500;\r\n              display: flex;\r\n              align-items: center;\r\n              justify-content: center;\r\n              gap: 0.5rem;\r\n              cursor: pointer;\r\n              transition: all 0.2s ease;\r\n          }\r\n\r\n          .form-button:hover:not(:disabled) {\r\n              background-color: var(--color-primary-dark);\r\n          }\r\n\r\n          .form-button:disabled {\r\n              opacity: 0.7;\r\n              cursor: not-allowed;\r\n          }\r\n\r\n          /* Right Section */\r\n          .right-section {\r\n              width: 33.333333%;\r\n              background-color: var(--color-primary);\r\n              padding: 2rem;\r\n              display: flex;\r\n              flex-direction: column;\r\n              position: relative;\r\n          }\r\n\r\n          .right-content {\r\n              margin-top: 4rem;\r\n              color: var(--color-white);\r\n          }\r\n\r\n          .right-content p {\r\n              font-size: 1.5rem;\r\n              line-height: 1.4;\r\n          }\r\n\r\n          .powered-by {\r\n              position: absolute;\r\n              bottom: 6rem;\r\n              font-size: 1.5rem;\r\n              font-weight: 700;\r\n              color: var(--color-white);\r\n          }\r\n      `;\r\n    document.head.appendChild(style);\r\n  }\r\n\r\n  injectUtilityStyles() {\r\n    const style = document.createElement(\"style\");\r\n    style.textContent = `\r\n          /* Utility Classes */\r\n          .relative { position: relative; }\r\n          .absolute { position: absolute; }\r\n          .flex { display: flex; }\r\n          .items-center { align-items: center; }\r\n          .justify-center { justify-content: center; }\r\n          .gap-2 { gap: 0.5rem; }\r\n          .w-full { width: 100%; }\r\n          .h-full { height: 100%; }\r\n          .text-white { color: white; }\r\n          .bg-white { background-color: white; }\r\n          .overflow-hidden { overflow: hidden; }\r\n          .z-10 { z-index: 10; }\r\n          .space-y-2 > * + * { margin-top: 0.5rem; }\r\n          .space-y-6 > * + * { margin-top: 1.5rem; }\r\n      `;\r\n    document.head.appendChild(style);\r\n  }\r\n\r\n  injectAnimationStyles() {\r\n    const style = document.createElement(\"style\");\r\n    style.textContent = `\r\n          /* Grain Animation */\r\n          .main-content:before {\r\n              animation: grain 4s steps(10) infinite;\r\n              background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyBAMAAADsEZWCAAAAGFBMVEVMaXH///////////////////////////////////////////9/ePoGAAAACHRSTlMAGBonNDtASlb65KYAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAFD0lEQVQ4yx2TTWhcVRTH/+fe++67783LvDZJx1hLKlQFFcFuXMWdC7Ql2I0ILkUXbXEhrSBd2BbE0IWQgKBddBNcFCpSEAyiQrt2IW4UNwoukhRsTKck6WQyH+/jvnfvPefcjwv3/s9v8b+/QwDQg19VDIkiUCBAhQAibsACkH0E5O3tzdreeMrdvff+9vb2ixuAu1UHsSAtrdyrA9QIAC/cu9F7OIwOe/3+cXt4fPwkAM3ojI4t5YBmE5BmetDpxo92dzqdjyfj0+kz0zQPTvY+kX08tGQqpWEqIGknrbb1TqvX+5REz/XNRXv97jL0z6ZprEYqoAPA0Eqr1Ta/7XbNVzzPfnZ9Z2ey7Z+fTc+GUQxrCssCQFpJK8z7rZb7/uZmr900vVa/89vZ2Dsd+T1iqEQQKNJgXlZ23lmzbK0P/XC71tDq9fU7+5fj8fnIG85VCFwzQ5KSdrPZvOK5rqvVSLkn6vcPL0fToS+YADDDG1Qx2mGz0TDfXXGcTsuyPvJOj5+eDvv9+FgJ0AAoyAHCBq+/67muuzJrGLVyo1a5NhyfBfE0QhGgITBDggR/08SH7ebqrF4v+xeB/30cngzm8WipRcRiAVBBOkr9F6/UdN3GDQz+aMd8URvOw+FcqwxCAdJCYkRZJ4rjpQa31suN50Uci7KSaWwVgtkaMXB+fhlHUZQsFYZcJgmAK/9FWGgR6RwAipwkqaRfbheypWAYRUk6S1d9zxdIlqYXhJ4qYiRG7uGMEi09z1PsiwQ6LWxEo5lXC5hoZSYV0iRWrFCInTwAFgLQQhZKQokhHTyYS2EsBSI0xEIgEsCRwVEkEksYgZGAUQW5wP8NOYwx8UFZA0qlFEgGmEIAiQJSFyB0oQIpC0CKpUI0EYAkgJUnJQoDWCAa1EABEAEAYpICQEFE/wLQ4FIJKBAGmAFBCYNZAUEAQIYxBBE4UhSHsWRYAFQRUCQgmKSCRzl+ZEAyiJgw3ghJ4hlAiKRMADAJKEiK7NJHpGqsAQhDEL+mF6AQChFkwBggcEVNh4o9JT0CuADoAIGGtCAGyzgPBsWj4a8vv7q5mKvlhEgKDFBENHUl6SnZ8ACgBQV4MZPEXMwFZuzY+fzrh2u12qyxtl7+2iBuWQiDGYyRxN2QS/0KgMQ1WqcYzZL4vFc1n/R+uO27lc21h2Udy9uA1hljK2kMgxY0gAAIS2gpsSCKGPq4WvGcr75/uVR0rXLrthiclO2i72mMFAF1IgYBYCWRW/UU1v0PW4bhrlSM8nfnl74ppdSU5XAeaakQsQSCWAEpxKK/1ry9bZn2m0YZhWKlqNOyxGiMOJ5HGlEiIJJA5KIkPsE8HRiF4r2y7fzKXF6aDKBgX/pz6KtckRhKQKiFeZauv9tynbJhmAQQU9Cp5Eo+8WweRqqGWEgKWKTxSavytuUUS7ZjMKaYtTxhLSVnQjBBqgygApBWPOGl/9TpteaUAWAqmAh1E4dpspQwSGlFjPFd/4Xu7rOvvc7mZsUqlXN6QbX0z2kS+3FWzkABlBaUBs3gS7sdJq1eZ2U8j31KUhb746FcSrATQjRfJhBTCmlrVdpJ2r3e/s9B6KfzJFGm+DcdBDG0KYq6jMrCkSJClClCZPXg++E4OP0WsKxxPhlN07wqPuJqPa23XGG8/uG1VbOk12yX5fV9LzyfLnWRp3cBBv8AL4A74Q+hss4AAAAASUVORK5CYII=);\r\n              content: \"\";\r\n              height: 350%;\r\n              left: -50%;\r\n              opacity: 0.02;\r\n              position: fixed;\r\n              top: -150%;\r\n              width: 300%;\r\n              z-index: 999 !important;\r\n              pointer-events: none;\r\n          }\r\n\r\n          @keyframes grain {\r\n              0%, 100% { transform: translate(0, 0); }\r\n              10% { transform: translate(-5%, -10%); }\r\n              20% { transform: translate(-15%, 5%); }\r\n              30% { transform: translate(7%, -25%); }\r\n              40% { transform: translate(-5%, 25%); }\r\n              50% { transform: translate(-15%, 10%); }\r\n              60% { transform: translate(15%, 0%); }\r\n              70% { transform: translate(0%, 15%); }\r\n              80% { transform: translate(3%, 35%); }\r\n              90% { transform: translate(-10%, 10%); }\r\n          }\r\n\r\n          /* Decorative Wave Animation */\r\n          .wave-animation {\r\n              animation: wave 10s ease-in-out infinite;\r\n              transform-origin: center bottom;\r\n          }\r\n\r\n          @keyframes wave {\r\n              0%, 100% { transform: translateY(0); }\r\n              50% { transform: translateY(-10px); }\r\n          }\r\n\r\n          /* Loading Spinner Animation */\r\n          .spinner {\r\n              animation: spin 1s linear infinite;\r\n          }\r\n\r\n          @keyframes spin {\r\n              from { transform: rotate(0deg); }\r\n              to { transform: rotate(360deg); }\r\n          }\r\n\r\n          /* Character Animation */\r\n          .char {\r\n              transform: translateY(115px);\r\n              transition: transform 0.5s;\r\n          }\r\n\r\n          /* Selection Style */\r\n          ::selection {\r\n              background-color: var(--color-primary-light);\r\n              color: var(--color-primary);\r\n          }\r\n      `;\r\n    document.head.appendChild(style);\r\n  }\r\n\r\n  render() {\r\n    const app = document.getElementById(\"app\");\r\n    app.innerHTML = this.getTemplate();\r\n    this.attachEventListeners();\r\n    this.initializeAnimations();\r\n  }\r\n\r\n  getTemplate() {\r\n    return `\r\n        <div class=\"main-content\">\r\n            <!-- Logo Section -->\r\n            <div class=\"logo-section\">\r\n                ${this.getLogoTemplate()}\r\n            </div>\r\n\r\n            <!-- Main Layout -->\r\n            <div class=\"layout-grid\">\r\n                <!-- Left Form Section -->\r\n                <div class=\"form-section\">\r\n                    <div class=\"form-container\">\r\n                        <h2 class=\"form-title\">Get your quote</h2>\r\n                        ${this.getFormTemplate()}\r\n                    </div>\r\n                </div>\r\n\r\n                <!-- Right Content Section -->\r\n                <div class=\"right-section\">\r\n                    ${this.getRightContentTemplate()}\r\n                </div>\r\n\r\n                <!-- Decorative Waves -->\r\n                ${this.getWaveTemplate()}\r\n            </div>\r\n        </div>\r\n    `;\r\n  }\r\n\r\n  getLogoTemplate() {\r\n    return `\r\n        <img src=\"/src/assets/logo.svg\" alt=\"Logo\" class=\"logo-icon -ml-8 -mt-8\" style=\"width: 13rem; height: 13rem;\" />\r\n        \r\n    `;\r\n  }\r\n\r\n  getFormTemplate() {\r\n    return `\r\n        <form id=\"quote-form\" class=\"space-y-6\">\r\n            <!-- Provider Field -->\r\n            <div class=\"form-group\">\r\n                <label class=\"form-label\" for=\"provider\">\r\n                    Choose your electricity Provider\r\n                </label>\r\n                <input \r\n                    type=\"text\" \r\n                    id=\"provider\"\r\n                    class=\"form-input\"\r\n                    placeholder=\"e.g., MEPCO\"\r\n                    value=\"${this.state.provider}\"\r\n                    ${this.state.isLoading ? \"disabled\" : \"\"}\r\n                >\r\n            </div>\r\n\r\n            <!-- Reference Number Field -->\r\n            <div class=\"form-group\">\r\n                <label class=\"form-label\" for=\"referenceNumber\">\r\n                    Enter your bill reference number\r\n                </label>\r\n                <input \r\n                    type=\"text\" \r\n                    id=\"referenceNumber\"\r\n                    class=\"form-input\"\r\n                    placeholder=\"Enter reference number\"\r\n                    value=\"${this.state.referenceNumber}\"\r\n                    ${this.state.isLoading ? \"disabled\" : \"\"}\r\n                >\r\n            </div>\r\n\r\n            <!-- WhatsApp Field -->\r\n            <div class=\"form-group\">\r\n                <label class=\"form-label\" for=\"whatsapp\">\r\n                    Enter your WhatsApp phone Number\r\n                </label>\r\n                <input \r\n                    type=\"tel\" \r\n                    id=\"whatsapp\"\r\n                    class=\"form-input\"\r\n                    placeholder=\"+92 XXX XXXXXXX\"\r\n                    value=\"${this.state.whatsapp}\"\r\n                    ${this.state.isLoading ? \"disabled\" : \"\"}\r\n                >\r\n            </div>\r\n\r\n            <!-- Submit Button -->\r\n            <button \r\n                type=\"submit\" \r\n                class=\"form-button\"\r\n                ${this.state.isLoading ? \"disabled\" : \"\"}\r\n            >\r\n                ${this.getButtonContent()}\r\n            </button>\r\n\r\n            ${this.state.error ? this.getErrorTemplate() : \"\"}\r\n        </form>\r\n    `;\r\n  }\r\n\r\n  getButtonContent() {\r\n    if (this.state.isLoading) {\r\n      return `\r\n            <span>Processing</span>\r\n            ${this.getSpinnerTemplate()}\r\n        `;\r\n    }\r\n    return \"<span>Generate</span>\";\r\n  }\r\n\r\n  getSpinnerTemplate() {\r\n    return `\r\n        <svg class=\"spinner\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\">\r\n            <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" \r\n                stroke=\"currentColor\" stroke-width=\"4\" fill=\"none\"/>\r\n            <path class=\"opacity-75\" fill=\"currentColor\" \r\n                d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"/>\r\n        </svg>\r\n    `;\r\n  }\r\n\r\n  getRightContentTemplate() {\r\n    return `\r\n        <div class=\"right-content\">\r\n            <p>\r\n                Our AI tool quickly provides\r\n                <br />the ideal system size and\r\n                <br />savings estimate—no\r\n                <br />in-person consultation\r\n                <br />needed. Get the fastest\r\n                <br />solar quote in Pakistan!\r\n            </p>\r\n        </div>\r\n        <div class=\"powered-by\">\r\n            POWERED BY AI\r\n        </div>\r\n    `;\r\n  }\r\n\r\n  getWaveTemplate() {\r\n    return `\r\n        \r\n    `;\r\n  }\r\n\r\n  getErrorTemplate() {\r\n    return `\r\n        <div class=\"error-message\">\r\n            ${this.state.error}\r\n        </div>\r\n    `;\r\n  }\r\n\r\n  initializeAnimations() {\r\n    // Add any initial animations here\r\n    const poweredBy = document.querySelector(\".powered-by\");\r\n    if (poweredBy) {\r\n      poweredBy.style.opacity = \"0\";\r\n      setTimeout(() => {\r\n        poweredBy.style.transition = \"opacity 0.5s ease-in-out\";\r\n        poweredBy.style.opacity = \"1\";\r\n      }, 500);\r\n    }\r\n  }\r\n  attachEventListeners() {\r\n    // Form submission\r\n    const form = document.getElementById(\"quote-form\");\r\n    if (form) {\r\n      form.addEventListener(\"submit\", this.handleSubmit.bind(this));\r\n    }\r\n\r\n    // Input change handlers\r\n    const inputs = document.querySelectorAll(\".form-input\");\r\n    inputs.forEach((input) => {\r\n      input.addEventListener(\"input\", this.handleInput.bind(this));\r\n      input.addEventListener(\"focus\", this.handleFocus.bind(this));\r\n      input.addEventListener(\"blur\", this.handleBlur.bind(this));\r\n    });\r\n\r\n    // Add phone number formatting\r\n    const whatsappInput = document.getElementById(\"whatsapp\");\r\n    if (whatsappInput) {\r\n      whatsappInput.addEventListener(\r\n        \"input\",\r\n        this.formatPhoneNumber.bind(this)\r\n      );\r\n    }\r\n  }\r\n\r\n  handleInput(event) {\r\n    const { id, value } = event.target;\r\n    this.state[id] = value;\r\n\r\n    // Clear error when user starts typing\r\n    if (this.state.error) {\r\n      this.state.error = null;\r\n      this.updateErrorDisplay();\r\n    }\r\n\r\n    // Add input validation class\r\n    this.validateField(event.target);\r\n  }\r\n\r\n  handleFocus(event) {\r\n    const field = event.target;\r\n    field.parentElement.classList.add(\"focused\");\r\n\r\n    // Add subtle highlight animation\r\n    field.style.transition = \"all 0.2s ease\";\r\n    field.style.transform = \"scale(1.01)\";\r\n  }\r\n\r\n  handleBlur(event) {\r\n    const field = event.target;\r\n    field.parentElement.classList.remove(\"focused\");\r\n\r\n    // Remove highlight animation\r\n    field.style.transform = \"scale(1)\";\r\n\r\n    // Validate field on blur\r\n    this.validateField(field);\r\n  }\r\n\r\n  validateField(field) {\r\n    const { id, value } = field;\r\n    let isValid = true;\r\n    let errorMessage = \"\";\r\n\r\n    switch (id) {\r\n      case \"provider\":\r\n        isValid = value.trim().length >= 2;\r\n        errorMessage = \"Provider name must be at least 2 characters\";\r\n        break;\r\n\r\n      case \"referenceNumber\":\r\n        isValid = /^[A-Za-z0-9-]{4,}$/.test(value.trim());\r\n        errorMessage = \"Please enter a valid reference number\";\r\n        break;\r\n\r\n      case \"whatsapp\":\r\n        isValid = /^\\+92\\s?3\\d{2}[-\\s]?\\d{7}$/.test(value.trim());\r\n        errorMessage =\r\n          \"Please enter a valid Pakistani phone number (e.g., +92 3XX XXXXXXX)\";\r\n        break;\r\n    }\r\n\r\n    // Update field styling\r\n    if (value) {\r\n      field.classList.toggle(\"invalid\", !isValid);\r\n      field.classList.toggle(\"valid\", isValid);\r\n\r\n      // Show/hide error message\r\n      const errorElement = field.parentElement.querySelector(\".field-error\");\r\n      if (!isValid) {\r\n        if (!errorElement) {\r\n          const error = document.createElement(\"div\");\r\n          error.className = \"field-error\";\r\n          error.textContent = errorMessage;\r\n          field.parentElement.appendChild(error);\r\n        }\r\n      } else if (errorElement) {\r\n        errorElement.remove();\r\n      }\r\n    }\r\n\r\n    return isValid;\r\n  }\r\n\r\n  formatPhoneNumber(event) {\r\n    let input = event.target;\r\n    let value = input.value.replace(/[^\\d+]/g, \"\"); // Keep digits and the plus sign only\r\n\r\n    // Format as +92 3XX XXXXXXX\r\n    if (value.startsWith(\"+92\")) {\r\n      if (value.length > 3) {\r\n        value =\r\n          value.slice(0, 3) +\r\n          \" \" +\r\n          value.slice(3, 6) +\r\n          \" \" +\r\n          value.slice(6, 13);\r\n      }\r\n    }\r\n\r\n    input.value = value;\r\n    this.state.whatsapp = value;\r\n  }\r\n\r\n  async handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    if (this.state.isLoading) return;\r\n\r\n    // Validate all fields\r\n    const form = event.target;\r\n    const fields = form.querySelectorAll(\".form-input\");\r\n    let isValid = true;\r\n\r\n    fields.forEach((field) => {\r\n      if (!this.validateField(field)) {\r\n        isValid = false;\r\n      }\r\n    });\r\n\r\n    if (!isValid) {\r\n      this.showError(\"Please correct the errors in the form\");\r\n      return;\r\n    }\r\n\r\n    // Start loading state\r\n    this.setState({ isLoading: true, error: null });\r\n    this.updateFormState();\r\n\r\n    try {\r\n      // Show processing animation\r\n      this.showProcessingAnimation();\r\n\r\n      // Call the imported fetchBillData function\r\n      await fetchBillData(this.state.referenceNumber);\r\n\r\n      // Navigate to quote page on success\r\n      window.router.push(\"/quote\");\r\n    } catch (error) {\r\n      console.error(\"Error generating quote:\", error);\r\n      this.showError(\"Failed to generate quote. Please try again.\");\r\n    } finally {\r\n      this.setState({ isLoading: false });\r\n      this.updateFormState();\r\n    }\r\n  }\r\n\r\n\r\n  setState(newState) {\r\n    this.state = { ...this.state, ...newState };\r\n  }\r\n\r\n  updateFormState() {\r\n    // Update button state\r\n    const button = document.querySelector(\".form-button\");\r\n    if (button) {\r\n      button.innerHTML = this.getButtonContent();\r\n      button.disabled = this.state.isLoading;\r\n    }\r\n\r\n    // Update input fields\r\n    const inputs = document.querySelectorAll(\".form-input\");\r\n    inputs.forEach((input) => {\r\n      input.disabled = this.state.isLoading;\r\n    });\r\n\r\n    // Update error display\r\n    this.updateErrorDisplay();\r\n  }\r\n\r\n  updateErrorDisplay() {\r\n    const errorContainer = document.querySelector(\".error-message\");\r\n    if (errorContainer) {\r\n      errorContainer.textContent = this.state.error || \"\";\r\n      errorContainer.style.display = this.state.error ? \"block\" : \"none\";\r\n    }\r\n  }\r\n\r\n  showError(message) {\r\n    this.setState({ error: message });\r\n    this.updateErrorDisplay();\r\n\r\n    // Add shake animation to form\r\n    const form = document.getElementById(\"quote-form\");\r\n    form.classList.add(\"shake\");\r\n    setTimeout(() => form.classList.remove(\"shake\"), 820); // Match shake animation duration\r\n  }\r\n\r\n  showProcessingAnimation() {\r\n    const button = document.querySelector(\".form-button\");\r\n    if (button) {\r\n      button.classList.add(\"processing\");\r\n\r\n      // Add loading dots animation\r\n      const span = button.querySelector(\"span\");\r\n      if (span) {\r\n        const dots = document.createElement(\"span\");\r\n        dots.className = \"loading-dots\";\r\n        span.appendChild(dots);\r\n      }\r\n    }\r\n  }\r\n  injectUtilityStyles() {\r\n    const style = document.createElement(\"style\");\r\n    style.textContent = `\r\n        ${this.getBaseUtilityStyles()}\r\n        ${this.getFormAnimationStyles()}\r\n        ${this.getValidationStyles()}\r\n        ${this.getLoadingStyles()}\r\n        ${this.getErrorStyles()}\r\n        ${this.getResponsiveStyles()}\r\n    `;\r\n    document.head.appendChild(style);\r\n  }\r\n\r\n  getBaseUtilityStyles() {\r\n    return `\r\n        .form-input.valid {\r\n            border-color: var(--color-primary);\r\n            background-color: var(--color-primary-light);\r\n        }\r\n\r\n        .form-input.invalid {\r\n            border-color: #ef4444;\r\n            background-color: rgba(239, 68, 68, 0.1);\r\n        }\r\n\r\n        .focused .form-label {\r\n            color: var(--color-primary);\r\n            transform: translateY(-1.5rem) scale(0.85);\r\n        }\r\n\r\n        .field-wrapper {\r\n            position: relative;\r\n            padding-bottom: 1.5rem;\r\n        }\r\n    `;\r\n  }\r\n\r\n  getFormAnimationStyles() {\r\n    return `\r\n        @keyframes shake {\r\n            0%, 100% { transform: translateX(0); }\r\n            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }\r\n            20%, 40%, 60%, 80% { transform: translateX(5px); }\r\n        }\r\n\r\n        .shake {\r\n            animation: shake 0.82s cubic-bezier(.36,.07,.19,.97) both;\r\n        }\r\n\r\n        .form-button.processing {\r\n            position: relative;\r\n            overflow: hidden;\r\n        }\r\n\r\n        .form-button.processing::after {\r\n            content: '';\r\n            position: absolute;\r\n            top: 0;\r\n            left: -100%;\r\n            width: 200%;\r\n            height: 100%;\r\n            background: linear-gradient(\r\n                90deg,\r\n                transparent 0%,\r\n                rgba(255,255,255,0.2) 50%,\r\n                transparent 100%\r\n            );\r\n            animation: loading-shine 1.5s infinite;\r\n        }\r\n\r\n        @keyframes loading-shine {\r\n            from { transform: translateX(-100%); }\r\n            to { transform: translateX(100%); }\r\n        }\r\n\r\n        .loading-dots::after {\r\n            content: '';\r\n            animation: loading-dots 1.5s infinite;\r\n        }\r\n\r\n        @keyframes loading-dots {\r\n            0% { content: ''; }\r\n            25% { content: '.'; }\r\n            50% { content: '..'; }\r\n            75% { content: '...'; }\r\n            100% { content: ''; }\r\n        }\r\n    `;\r\n  }\r\n\r\n  getValidationStyles() {\r\n    return `\r\n        .field-error {\r\n            position: absolute;\r\n            bottom: 0;\r\n            left: 0;\r\n            font-size: 0.75rem;\r\n            color: #ef4444;\r\n            transition: all 0.2s ease;\r\n        }\r\n\r\n        .form-input.valid + .field-error {\r\n            opacity: 0;\r\n            transform: translateY(-10px);\r\n        }\r\n\r\n        .form-input.invalid + .field-error {\r\n            opacity: 1;\r\n            transform: translateY(0);\r\n        }\r\n    `;\r\n  }\r\n\r\n  getLoadingStyles() {\r\n    return `\r\n        .spinner {\r\n            animation: spin 1s linear infinite;\r\n        }\r\n\r\n        @keyframes spin {\r\n            from { transform: rotate(0deg); }\r\n            to { transform: rotate(360deg); }\r\n        }\r\n\r\n        .form-button:disabled {\r\n            cursor: not-allowed;\r\n            opacity: 0.7;\r\n        }\r\n\r\n        .form-button:disabled:hover {\r\n            transform: none;\r\n            background-color: var(--color-primary);\r\n        }\r\n    `;\r\n  }\r\n\r\n  getErrorStyles() {\r\n    return `\r\n        .error-message {\r\n            background-color: rgba(239, 68, 68, 0.1);\r\n            border-radius: 0.375rem;\r\n            padding: 0.75rem;\r\n            color: #ef4444;\r\n            margin-top: 1rem;\r\n            font-size: 0.875rem;\r\n            display: flex;\r\n            align-items: center;\r\n            gap: 0.5rem;\r\n        }\r\n\r\n        .error-message::before {\r\n            content: '⚠️';\r\n        }\r\n    `;\r\n  }\r\n\r\n  getResponsiveStyles() {\r\n    return `\r\n        @media (max-width: 768px) {\r\n            .layout-grid {\r\n                flex-direction: column;\r\n            }\r\n\r\n            .form-section,\r\n            .right-section {\r\n                width: 100%;\r\n            }\r\n\r\n            .right-section {\r\n                padding: 2rem 1rem;\r\n            }\r\n\r\n            .form-container {\r\n                padding: 1rem;\r\n            }\r\n\r\n            .logo-section {\r\n                position: relative;\r\n                top: 0;\r\n                left: 0;\r\n                padding: 1rem;\r\n            }\r\n\r\n            .form-title {\r\n                font-size: 1.875rem;\r\n            }\r\n\r\n            .right-content p {\r\n                font-size: 1.25rem;\r\n            }\r\n\r\n            .powered-by {\r\n                position: relative;\r\n                bottom: auto;\r\n                margin-top: 2rem;\r\n            }\r\n        }\r\n\r\n        @media (max-width: 480px) {\r\n            .form-title {\r\n                font-size: 1.5rem;\r\n            }\r\n\r\n            .right-content p {\r\n                font-size: 1rem;\r\n            }\r\n        }\r\n    `;\r\n  }\r\n}\r\n"
        }
    ]
}